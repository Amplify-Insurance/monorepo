type GenericEvent @entity {
  id: ID!
  blockNumber: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
  eventName: String!
  data: String!
}

# New entities with minimal fields for the demo
type Pool @entity {
  id: ID!
  underlyingAsset: Bytes!
  protocolToken: Bytes!
  protocolCovered: Int!
}

type Underwriter @entity {
  id: ID!
  totalDeposited: BigInt!
  masterShares: BigInt!
}

type Policy @entity {
  id: ID!
  owner: Bytes!
  pool: Pool!
  coverageAmount: BigInt!
  premiumPaid: BigInt!
  premiumRateBps: BigInt!
}

type ContractOwner @entity {
  id: ID!
  owner: Bytes!
}

type PoolUtilizationSnapshot @entity {
  id: ID!
  pool: Pool!
  timestamp: BigInt!
  blockNumber: BigInt!
  utilizationBps: BigInt!
  premiumRateBps: BigInt!
}

type Claim @entity {
  id: ID!
  policyId: BigInt!
  poolId: BigInt!
  claimant: Bytes!
  coverage: BigInt!
  netPayoutToClaimant: BigInt!
  claimFee: BigInt!
  protocolTokenAmountReceived: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}

type PolicyCreatedEvent @entity {
  id: ID!
  policyId: BigInt!
  poolId: BigInt!
  user: Bytes!
  coverage: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}

type PolicyLapsedEvent @entity {
  id: ID!
  policyId: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}

type PremiumPaidEvent @entity {
  id: ID!
  policyId: BigInt!
  poolId: BigInt!
  amountPaid: BigInt!
  catAmount: BigInt!
  poolIncome: BigInt!
  timestamp: BigInt!
  transactionHash: Bytes!
}

type GovernanceProposal @entity {
  id: ID!
  proposer: Bytes!
  poolId: BigInt!
  pauseState: Boolean!
  votingDeadline: BigInt!
  executed: Boolean!
  passed: Boolean
  forVotes: BigInt!
  againstVotes: BigInt!
  abstainVotes: BigInt!
  votes: [GovernanceVote!] @derivedFrom(field: "proposal")
}

type GovernanceVote @entity {
  id: ID!
  proposal: GovernanceProposal!
  voter: Bytes!
  vote: Int!
  weight: BigInt!
}
